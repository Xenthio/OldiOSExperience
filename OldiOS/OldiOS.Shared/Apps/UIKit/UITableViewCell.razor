@* iOS 5 UITableViewCell Component *@
@using OldiOS.Shared.Apps.UIKit
@using OldiOS.Shared.Components

<div class="uitableviewcell @(IsLast ? "last" : "") @(IsSelectable ? "selectable" : "")" @onclick="OnClick">
    @if (!string.IsNullOrEmpty(TrackNumber))
    {
        <div class="cell-track-number">@TrackNumber</div>
    }
    
    @if (!string.IsNullOrEmpty(Icon))
    {
        <div class="cell-icon">
            <LocalImage ImageSrc="@Icon" Alt="" />
        </div>
    }
    
    <div class="cell-content">
        <div class="cell-text">@Text</div>
        @if (!string.IsNullOrEmpty(Detail))
        {
            <div class="cell-detail">@Detail</div>
        }
    </div>
    
    @if (!string.IsNullOrEmpty(RightDetail))
    {
        <div class="cell-right-detail">@RightDetail</div>
    }
    
    @if (ShowDisclosure)
    {
        <div class="cell-accessory disclosure"></div>
    }
    else if (ShowCheckmark)
    {
        <div class="cell-accessory checkmark">âœ“</div>
    }
    else if (ShowToggle)
    {
        <div class="cell-toggle">
            <UISwitch Value="@ToggleValue" OnChange="@HandleToggleChange" OnTrackColor="@ToggleOnTrackColor" />
        </div>
    }
</div>

@code {
    [Parameter]
    public required string Text { get; set; }
    
    [Parameter]
    public string? Detail { get; set; }
    
    [Parameter]
    public string? Icon { get; set; }
    
    [Parameter]
    public string? TrackNumber { get; set; }
    
    [Parameter]
    public string? RightDetail { get; set; }
    
    [Parameter]
    public bool ShowDisclosure { get; set; } = false;
    
    [Parameter]
    public bool ShowCheckmark { get; set; } = false;
    
    [Parameter]
    public bool ShowToggle { get; set; } = false;
    
    [Parameter]
    public bool ToggleValue { get; set; } = false;
    
    [Parameter]
    public string? ToggleOnTrackColor { get; set; }

    [Parameter]
    public EventCallback<bool> OnToggleChange { get; set; }
    
    [Parameter]
    public EventCallback OnClick { get; set; }
    
    [Parameter]
    public bool IsLast { get; set; } = false;

    public bool IsSelectable => ShowDisclosure || OnClick.HasDelegate;
    
    private async Task HandleToggleChange(bool newValue)
    {
        await OnToggleChange.InvokeAsync(newValue);
    }
}
