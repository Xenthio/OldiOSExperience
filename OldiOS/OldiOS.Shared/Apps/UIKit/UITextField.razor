@* iOS 5 UITextField Component *@

<div class="uitextfield-container @(FullWidth ? "full-width" : "")">
    @if (!string.IsNullOrEmpty(Label))
    {
        <label class="textfield-label">@Label</label>
    }
    <div class="uitextfield-wrapper @(Focused ? "focused" : "") @(Disabled ? "disabled" : "")">
        @if (!string.IsNullOrEmpty(LeftIcon))
        {
            <img src="@LeftIcon" alt="" class="textfield-icon left" />
        }
        <input type="@InputType"
               class="uitextfield"
               placeholder="@Placeholder"
               value="@Value"
               disabled="@Disabled"
               @oninput="HandleInput"
               @onfocus="HandleFocus"
               @onblur="HandleBlur" />
        @if (ShowClearButton && !string.IsNullOrEmpty(Value))
        {
            <button class="clear-button" @onclick="HandleClear" type="button">
                <span class="clear-icon">âœ•</span>
            </button>
        }
        @if (!string.IsNullOrEmpty(RightIcon))
        {
            <img src="@RightIcon" alt="" class="textfield-icon right" />
        }
    </div>
</div>

@code {
    [Parameter]
    public string? Value { get; set; }
    
    [Parameter]
    public EventCallback<string> ValueChanged { get; set; }
    
    [Parameter]
    public string? Placeholder { get; set; }
    
    [Parameter]
    public string? Label { get; set; }
    
    [Parameter]
    public string InputType { get; set; } = "text";
    
    [Parameter]
    public bool Disabled { get; set; } = false;
    
    [Parameter]
    public bool FullWidth { get; set; } = true;
    
    [Parameter]
    public bool ShowClearButton { get; set; } = true;
    
    [Parameter]
    public string? LeftIcon { get; set; }
    
    [Parameter]
    public string? RightIcon { get; set; }
    
    [Parameter]
    public EventCallback OnFocus { get; set; }
    
    [Parameter]
    public EventCallback OnBlur { get; set; }
    
    private bool Focused { get; set; } = false;
    
    private async Task HandleInput(ChangeEventArgs e)
    {
        Value = e.Value?.ToString();
        await ValueChanged.InvokeAsync(Value);
    }
    
    private async Task HandleFocus()
    {
        Focused = true;
        await OnFocus.InvokeAsync();
    }
    
    private async Task HandleBlur()
    {
        Focused = false;
        await OnBlur.InvokeAsync();
    }
    
    private async Task HandleClear()
    {
        Value = string.Empty;
        await ValueChanged.InvokeAsync(Value);
    }
}
