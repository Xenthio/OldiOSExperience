<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <base href="/" />
    <link rel="stylesheet" href="_content/OldiOS.Shared/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="_content/OldiOS.Shared/css/app.css" />
    <link rel="stylesheet" href="OldiOS.Web.styles.css" />
    <link rel="icon" type="image/png" href="_content/OldiOS.Shared/favicon.png" />
    <HeadOutlet @rendermode="new InteractiveWebAssemblyRenderMode(prerender: false)" />
</head>

<body>
    <div id="blazor-loading-screen" class="boot-wrapper">
        <div class="boot-phone-container">
            <div class="boot-screen-viewport">
                <img src="_content/OldiOS.Shared/images/apple-logo.png" alt="Apple" class="boot-apple-logo" />
            </div>
            <div class="boot-home-button">
                <div class="boot-home-button-square"></div>
            </div>
        </div>
    </div>
    
    <Routes @rendermode="new InteractiveWebAssemblyRenderMode(prerender: false)" />
    
    <script src="_framework/blazor.web.js"></script>
    <script src="_content/OldiOS.Shared/js/app-animations.js"></script>
    <script src="_content/OldiOS.Shared/js/utils.js"></script>
    <script src="_content/OldiOS.Shared/js/battery.js"></script>
    <script src="_content/OldiOS.Shared/js/pressure.js"></script>
    <script>
        window.getElementWidth = (element) => {
            return element.getBoundingClientRect().width;
        };
        
        // Hide loading screen when Blazor has initialized
        document.addEventListener('DOMContentLoaded', () => {
            // Wait for Blazor to fully initialize and render
            const observer = new MutationObserver((mutations, obs) => {
                // Check if Routes component has rendered content
                if (document.querySelector('.simulation-wrapper') || document.querySelector('.lock-screen')) {
                    const loadingScreen = document.getElementById('blazor-loading-screen');
                    if (loadingScreen) {
                        loadingScreen.style.display = 'none';
                    }
                    obs.disconnect();
                }
            });
            
            observer.observe(document.body, {
                childList: true,
                subtree: true
            });
            
            // Fallback: hide after 5 seconds if Blazor hasn't rendered
            setTimeout(() => {
                const loadingScreen = document.getElementById('blazor-loading-screen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
            }, 5000);
        });
    </script>
</body>

</html>
